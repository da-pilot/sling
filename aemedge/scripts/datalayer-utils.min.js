(function(){console.log("[DataLayer-Utils] Starting data layer initialization");if(window.adobeDataLayer&&window.adobeDataLayer.version){console.warn("[DataLayer-Utils] Adobe Client Data Layer already loaded");return}console.log("[DataLayer-Utils] Initializing Adobe Data Layer");window.adobeDataLayer=window.adobeDataLayer||[];function initializeDataLayer(options){const dataLayer=options?.dataLayer||[];dataLayer.version="2.0.2";dataLayer.getState=function(path){const state=this._state||{};return path?state[path]:{...state}};dataLayer.addEventListener=function(event,handler,listenerOptions){this._listeners=this._listeners||{};this._listeners[event]=this._listeners[event]||[];this._listeners[event].push({handler,options:listenerOptions})};const originalPush=dataLayer.push;dataLayer.push=function(data){this._state=this._state||{};if(data&&typeof data==="object"&&!data.event){Object.assign(this._state,data)}return originalPush.call(this,data)};return dataLayer}const DataLayerHelpers={pushInitialData(appName="eds-marketing-site"){const data={web:{webPageDetails:{platform:"web",_sling:{appName,analyticsVersion:"7.0.39"}}}};window.adobeDataLayer.push(data)},pushPageData(pageInfo={}){const{name=window.location.pathname,lineOfBusiness="domestic",classification="us",type="generic",lang="en",domain=window.location.hostname,siteSection=lineOfBusiness,siteSubSection=classification,qsp="",isErrorPage=false}=pageInfo;const data={web:{webPageDetails:{name,type,qsp,language:lang,siteSection,siteSubSection,domain,isErrorPage,_sling:{lineOfBusiness,classification,domain,appName:"eds-marketing-site"}}}};window.adobeDataLayer.push(data)},pushScreenLoad(){const data={event:"screen_load",screenLoadFired:true,web:{currentEvent:"screen_load"}};window.adobeDataLayer.push(data)},getPageData(){const{pathname}=window.location;const isHomePage=pathname==="/";const data={name:isHomePage?"home":pathname,type:"generic",lineOfBusiness:"domestic",classification:"us"};if(isHomePage){data.type="home"}return data},pushCartData(cartInfo={}){const{category="acquisition",subCategory="simple-shop",referrer="unknown",planName="monthly",offerName="",deviceBundle="",subType="paid",basePreselect=[],extrasPreselect=[]}=cartInfo;const packagePreselect=[...basePreselect,...extrasPreselect];const formattedPackagePreselect=packagePreselect.join("|");const data={commerce:{cart:{_sling:{category,subCategory,referrer,planName,offerName,deviceBundle,subType,basePreselect,extrasPreselect,packagePreselect,formattedPackagePreselect}}}};window.adobeDataLayer.push(data)},pushCartStep(stepName="account"){const eventName=`cart_step_${stepName}`;const data={event:eventName,web:{currentEvent:eventName}};window.adobeDataLayer.push(data)},updatePageType(type="cart"){const data={web:{webPageDetails:{name:window.location.pathname,type}}};window.adobeDataLayer.push(data)}};initializeDataLayer({dataLayer:window.adobeDataLayer});setTimeout(async()=>{console.log("[DataLayer-Utils] Auto-initializing data layer");const appName="eds-marketing-site";const pageData=DataLayerHelpers.getPageData();const skipAnalytics=!!document.querySelector(".skipAnalytics");DataLayerHelpers.pushInitialData(appName);if(!skipAnalytics){const isActualCartPage=window.location.pathname.includes("/cart")||window.location.pathname.includes("/checkout")||window.location.pathname.includes("/account-form");if(isActualCartPage){console.log("[DataLayer-Utils] Cart page detected, pushing cart data");DataLayerHelpers.pushCartData();DataLayerHelpers.pushCartStep("account");DataLayerHelpers.updatePageType("cart")}DataLayerHelpers.pushPageData(pageData);DataLayerHelpers.pushScreenLoad()}},0);window.SlingDataLayer={helpers:DataLayerHelpers,initialize:initializeDataLayer}})();